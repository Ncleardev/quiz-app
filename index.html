<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz z pytaniami</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 2em;
      background-color: black;
      color: white;
    }
    .question-container {
      max-width: 600px;
      margin: auto;
      padding: 1.5em;
      border-radius: 12px;
      background-color: rgba(255, 255, 255, 0.1);
      box-shadow: 0 0 8px rgba(255, 255, 255, 0.1);
    }
    .question {
      font-size: 1.2em;
      margin-bottom: 1em;
    }
    .answers button {
      display: block;
      background-color: #0b3e75;
      padding: 0.8em;
      margin: 0.5em auto;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      max-width: 100%;
      color: white;
      border: transparent solid 5px;
    }
    .answers button.correct {
      background-color: #1b742f;
    }
    .answers button.wrong {
      background-color: #7b1d26;
    }
    .answers button.selected {
      border: white solid 5px;
    }
    .next-btn {
      background-color: #146774;
      padding: 0.8em;
      margin-top: 1em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: white;
    }

    .upload {
  display: inline-block;
  background-color: #0b3e75;
  color: white;
  padding: 0.5em 1em;
  text-decoration: none;
  border-radius: 8px;
  cursor: pointer;
  opacity: 0.75;
}

.upload:hover {
  opacity: 1;
}

  </style>
</head>
<body>
  <label for="file-input">
    <a class="upload">Import</a>
  </label>
  <input type="file" id="file-input" accept=".txt" style="display: none;" />
  <a class="upload" onclick="startQuiz()">Refresh</a>
  <br><br>
  <div class="question-container">
    <div id="question" class="question"></div>
    <div id="answers" class="answers"></div>
    <button id="next-btn" class="next-btn">Next</button>
  </div>

  

  <script>
    var questions;
document.getElementById('file-input').addEventListener('change', function(e) {
  const file = e.target.files[0];
  const reader = new FileReader();
  
  reader.onload = function(e) {
    const text = e.target.result;
    questions = parseQuestions(text);
    startQuiz();
  };
  
  reader.readAsText(file);
});

function parseQuestions(text) {
  const lines = text.split('\n').map(line => line.trim()).filter(line => line);
  const questions = [];
  let currentQuestion = null;
  let processingQuestion = false;

  for (const line of lines) {
    const questionMatch = line.match(/^\d+\.\s*(.*)/);
    
    // Nowe pytanie
    if (questionMatch) {
      if (currentQuestion) questions.push(currentQuestion);
      currentQuestion = {
        question: questionMatch[1].trim(),
        answers: []
      };
      processingQuestion = true;
      continue;
    }

    // Odpowiedź
    const answerMatch = line.match(/^([a-d])[>)]\s*(.*)/i);
    if (answerMatch) {
      processingQuestion = false;
      const isCorrect = line[1] === '>';
      const answerText = answerMatch[2].replace(/,$/, '').trim();
      currentQuestion.answers.push({
        text: answerText,
        correct: isCorrect
      });
      continue;
    }

    // Kontynuacja treści pytania
    if (currentQuestion && processingQuestion) {
      currentQuestion.question += ' ' + line;
    }
  }

  if (currentQuestion) questions.push(currentQuestion);
  return questions;
}

    let shuffledQuestions, currentQuestionIndex;

    const questionElement = document.getElementById("question");
    const answersElement = document.getElementById("answers");
    const nextButton = document.getElementById("next-btn");

    nextButton.addEventListener("click", () => {
      currentQuestionIndex++;
      setNextQuestion();
    });

    function startQuiz() {
      shuffledQuestions = questions.sort(() => Math.random() - 0.5);
      currentQuestionIndex = 0;
      setNextQuestion();
    }

    function setNextQuestion() {
      resetState();
      showQuestion(shuffledQuestions[currentQuestionIndex]);
    }

    function showQuestion(questionData) {
      questionElement.textContent = questionData.question;
      questionData.answers.forEach(answer => {
        const button = document.createElement("button");
        button.textContent = answer.text;
        button.classList.add("answer-btn");
        if (answer.correct) {
          button.dataset.correct = answer.correct;
        }
        button.addEventListener("click", selectAnswer);
        answersElement.appendChild(button);
      });
    }

    function resetState() {
      clearStatusClass(document.body);
      nextButton.style.opacity = "0";
      while (answersElement.firstChild) {
        answersElement.removeChild(answersElement.firstChild);
      }
    }

    function selectAnswer(e) {
      const selectedButton = e.target;
      selectedButton.classList.add("selected");
      const correct = selectedButton.dataset.correct;
      setStatusClass(selectedButton, correct);
      Array.from(answersElement.children).forEach(button => {
        setStatusClass(button, button.dataset.correct);
        button.disabled = true;
      });
      if (shuffledQuestions.length > currentQuestionIndex + 1) {
        nextButton.style.opacity = "1";
      } else {
        nextButton.textContent = "Finish";
        nextButton.style.opacity = "1";
      }
    }

    function setStatusClass(element, correct) {
      clearStatusClass(element);
      if (correct) {
        element.classList.add("correct");
      } else {
        element.classList.add("wrong");
      }
    }

    function clearStatusClass(element) {
      element.classList.remove("correct");
      element.classList.remove("wrong");
    }
  </script>
</body>
</html>
